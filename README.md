[![lint-and-test](https://github.com/OzhoginCode/soccer-stat/actions/workflows/lint-and-test.yml/badge.svg)](https://github.com/OzhoginCode/soccer-stat/actions/workflows/lint-and-test.yml)

# Soccer Stat
Приложение для просмотра спортивной статистики «Soccer Stat»

## Доступные команды
Для работы приложения требуется склонировать репозиторий и перейти в рабочую директорию:
```bash
git clone https://github.com/OzhoginCode/soccer-stat.git
cd soccer-stat
```
Для выполнения этой команды требуется только Docker:
* `make dev` - открытие приложения в режиме разработки

Для выполнения следующих команд требуется установленный Node.JS версии 18 и выше, npm, а также Make. Для начала нужно установить требуемые для работы пакеты, командой `make install`
* `make lint` - проверка кода приложения с помощью линтера
* `make build` - сборка приложения в поддиректорию dist
* `make test` - одиночный прогон тестов
* `make test-watch` - прогон тестов в режиме "watch"

## Описание
Основной стек: React, Vite, Tailwind, Vitest, React Testing Library, Docker

Разработка велась в тематических ветках, после завершения работы в ветке делал pull request и merge в ветку main.

При пулл реквесте в main настроены GitHub Actions с линтером и тестами, которые не дают замёрджить с ошибками. При мёрдже, проходят тесты и линтер; в случае успеха проект деплоится на GitHub Pages.

Проект упакован в Docker Compose. Настроены две разные сборки образов: для разработки и для прода.

Написаны интеграционные тесты на Vitest, проверяющие основную функциональность. Выбран Vitest вместо Jest, так как:
* Vitest поддерживает ESM синтаксис из коробки
* У Vitest нет проблем с Node.js globals, что нужно для работы msw (пакет для удобной работы с моками)
* У них почти одинаковый синтаксис, что улучшает поддержку
* Упрощает интеграцию, если в качестве сборщика используется Vite

В качестве css-фреймворка выбран Tailwind. Также подключены несколько библиотек с картинками и отдельными компонентами.

Реализовано переключение светлой/тёмной темы. Для этого решил использовать встроенные возможности tailwind, так как это заметно уменьшило количество логики в приложении. Выбранная пользователем тема сохраняется в Local Storage

#### Проблемы:
* Найдена проблема с открытой API: она не отправляет заголовок CORS, из-за чего не работает взаимодействие с API из-под GitHub Pages без специального расширения для браузера (например, [такого](https://chromewebstore.google.com/detail/cors-unblock/lfhmikememgdcahcdlaciloancbhjino)). Единственное возможное решение - написать небольшой прокси сервер, который будет добавлять этот заголовок в ответ. Но тогда уже, естественно, GitHub Pages не подойдёт. Эта проблема не касается dev режима, так как в нём я настроил проксирование с vite.

* Ещё одна проблема в API - она не даёт доступа к большинстве лиг (отдаёт 403). Можно проверить открытие страницы конкретной лиги, найдя в поиске и перейдя в, например, “Ligue 1”.

* Обнаружена следующая проблема на стороне GitHub Pages: когда открываешь или перезагружаешь страницу на любом адресе, отличном от корня (/), он отдаёт 404. Внутри приложения переход по ссылкам работает нормально, но загрузить с нуля GitHub Pages не даёт. Видимо, это связано с работой SPA. Решение проблемы вижу только в переходе с GitHub Actions на свой сервер.